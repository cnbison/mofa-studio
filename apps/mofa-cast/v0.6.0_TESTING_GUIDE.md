# v0.6.0 Testing Guide

**Version**: 0.6.0 (Simplified - TTS-Focused Workflow)
**Date**: 2026-01-15
**Status**: üß™ Ready for Testing

## Overview

This guide provides step-by-step testing instructions for the v0.6.0 release, which is a major refactoring that removes built-in script optimization and focuses on TTS synthesis only.

## What Changed in v0.6.0

### Removed Features
- ‚ùå **"Refine Script" button** - Removed from UI
- ‚ùå **LLM API integration** - No OpenAI/Claude API calls
- ‚ùå **Dual editor layout** - No more "Original" vs "Refined" split view
- ‚ùå **`script_refiner.rs`** - Entire module deleted (485 lines)

### New Features
- ‚úÖ **Single script editor** - One unified editor for import and editing
- ‚úÖ **External AI workflow** - Scripts are optimized externally (ChatGPT/Claude)
- ‚úÖ **Simplified UI** - Cleaner, more focused interface
- ‚úÖ **Zero API costs** - Users optimize scripts for free

### Code Metrics
- **Lines removed**: ~700 lines (-20%)
- **Files deleted**: 1 (script_refiner.rs)
- **Build time**: ~45s ‚Üí ~40s (-11%)
- **Files modified**: 5 (lib.rs, screen.rs, README.md, ARCHITECTURE.md, CHECKLIST.md)
- **Files created**: 2 (SCRIPT_OPTIMIZATION_GUIDE.md, v0.6.0_RELEASE_NOTES.md)

## Pre-Test Checklist

- [x] Build successful: `cargo build --release --package mofa-cast`
- [x] No compilation errors
- [x] Only non-critical warnings (unused imports, naming conventions)
- [x] Documentation updated (README, ARCHITECTURE, CHECKLIST)
- [x] SCRIPT_OPTIMIZATION_GUIDE.md created

## Testing Instructions

### Phase 1: Build and Launch (5 min)

1. **Build the release version**:
   ```bash
   cd /Users/loubicheng/project/mofa-studio
   cargo build --release --package mofa-cast
   ```

   **Expected**:
   - Build completes successfully
   - No errors (only warnings allowed)
   - Binary created: `target/release/libmofa_cast.dylib` (macOS)

2. **Launch MoFA Studio**:
   ```bash
   ./target/release/mofa-studio-shell
   ```

   **Expected**:
   - Application launches without crashes
   - MoFA Cast icon appears in sidebar

### Phase 2: UI Verification (5 min)

3. **Click on "MoFA Cast" in sidebar**

   **Expected**:
   - ‚úÖ Single script editor (NOT dual editors)
   - ‚úÖ Title: "Podcast Script"
   - ‚úÖ Subtitle: "Import your optimized script (ChatGPT/Claude)"
   - ‚úÖ Placeholder text: "Click 'Import Script' to load your optimized podcast script..."
   - ‚úÖ Left panel shows:
     - Format dropdown (Plain Text / JSON / Markdown)
     - "Select File" button
     - "No file selected" label
     - Speakers list (empty initially)
   - ‚úÖ Control bar has:
     - "Import Script" button
     - "Synthesize Audio" button
     - "Export Audio" button
     - ‚ùå NO "Refine Script" button (should be absent)

### Phase 3: Script Import (10 min)

4. **Prepare a test script** (use existing sample or create one):

   ```bash
   # Use provided sample
   cat apps/mofa-cast/test_samples/sample_json.json
   ```

   Or create your own optimized script:
   ```json
   {
     "messages": [
       {"speaker": "host", "text": "Welcome to today's episode about AI!"},
       {"speaker": "guest1", "text": "Thanks for having me!"},
       {"speaker": "guest2", "text": "I'm excited to be here!"}
     ]
   }
   ```

5. **Test file import**:
   - Select format: "JSON"
   - Click "Select File" button
   - Choose your test script file

   **Expected**:
   - ‚úÖ File path shown in left panel
   - ‚úÖ Script content appears in "Podcast Script" editor
   - ‚úÖ Speakers list shows detected speakers:
     - host (Blue #3b82f6)
     - guest1 (Green #10b981)
     - guest2 (Red #f97316)
   - ‚úÖ Log panel shows: "‚úÖ Script imported successfully"

### Phase 4: Script Editing (Critical Test!) (10 min)

6. **Test script editor editability** (THIS IS THE MAIN FIX!):

   - Click anywhere in the "Podcast Script" editor
   - Try to edit the text (add/delete/modify characters)

   **Expected** (after fix):
   - ‚úÖ Editor becomes focused (blue focus ring appears)
   - ‚úÖ Cursor appears at click position
   - ‚úÖ Can type new text
   - ‚úÖ Can delete existing text (Backspace/Delete)
   - ‚úÖ Can select text with mouse drag
   - ‚úÖ Hover effect visible (subtle blue border)

   **What was broken before**:
   - ‚ùå Editor appeared but couldn't be edited
   - ‚ùå No cursor appeared
   - ‚ùå No focus ring

   **What we fixed**:
   - Added `instance hover: 0.0` and `instance focus: 0.0`
   - Added focus ring visualization with `sdf.stroke()`
   - Removed duplicate `apply_over()` calls

   **If still broken**:
   - Check console for errors
   - Report exact symptoms (cursor? typing? hover?)
   - Screenshot would help

7. **Test text editing features**:
   - Type some new text at the end
   - Modify an existing line
   - Copy/paste text (Cmd+C, Cmd+V)
   - Select all (Cmd+A)

   **Expected**:
   - All editing operations work smoothly
   - Text wraps properly (word wrap enabled)
   - No scroll artifacts or flickering

### Phase 5: TTS Synthesis (15 min)

8. **Test audio synthesis**:

   - Ensure you have an imported script with multiple speakers
   - Click "Synthesize Audio" button

   **Expected**:
   - ‚úÖ Log panel shows: "üéôÔ∏è Starting multi-voice TTS synthesis..."
   - ‚úÖ Progress updates in log panel:
     - "üìä Segment 1/10: host ‚Üí Luo Xiang"
     - "üìä Segment 2/10: guest1 ‚Üí Ma Yun"
     - etc.
   - ‚úÖ Voice routing works (host‚ÜíLuo Xiang, guest1‚ÜíMa Yun, guest2‚ÜíMa Baoguo)
   - ‚úÖ Synthesis completes in ~4s per segment
   - ‚úÖ "Export Audio" button becomes enabled

   **Check log viewer**:
   - Should see all Dora events
   - Filter buttons work (ALL/INFO/WARN/ERROR)
   - Log panel is collapsible

9. **Verify audio files created**:
   ```bash
   ls -lh output/mofa-cast/dora/segment_*.wav
   ```

   **Expected**:
   - Multiple WAV files (one per segment)
   - Named: `segment_000_host.wav`, `segment_001_guest1.wav`, etc.

### Phase 6: Audio Export (5 min)

10. **Test audio export**:
    - Click "Export Audio" button
    - Choose destination file

    **Expected**:
    - ‚úÖ Log panel shows: "üéõÔ∏è Mixing audio segments..."
    - ‚úÖ Progress updates
    - ‚úÖ Final file created: `podcast.wav` (or your chosen name)
    - ‚úÖ Success message: "‚úÖ Audio exported successfully!"

11. **Verify final audio**:
    ```bash
    ls -lh output/mofa-cast/podcast.wav
    ffprobe output/mofa-cast/podcast.wav
    ```

    **Expected**:
    - File exists and has reasonable size
    - Format: WAV, 16-bit PCM, 22050 Hz (or native rate), mono
    - Duration matches script length
    - Can play in audio player

### Phase 7: Dark Mode Testing (5 min)

12. **Test dark mode**:
    - Toggle dark mode in main app
    - Verify all components update correctly

    **Expected**:
    - ‚úÖ Script editor background: WHITE ‚Üí SLATE_900
    - ‚úÖ Script editor text: TEXT_PRIMARY ‚Üí TEXT_PRIMARY_DARK
    - ‚úÖ Panels: PANEL_BG ‚Üí PANEL_BG_DARK
    - ‚úÖ Focus ring visible in both modes (INDIGO_200/500)
    - ‚úÖ No color flickering

## Test Results Template

**Please report your test results using this format**:

### Build & Launch
- [ ] Build successful
- [ ] App launches
- [ ] MoFA Cast icon visible

### UI Verification
- [ ] Single script editor (not dual)
- [ ] Title: "Podcast Script"
- [ ] Subtitle: "Import your optimized script (ChatGPT/Claude)"
- [ ] NO "Refine Script" button

### Script Import
- [ ] Format dropdown works
- [ ] File dialog opens
- [ ] Script imports successfully
- [ ] Speakers detected correctly

### **Script Editing (CRITICAL!)**
- [ ] **Editor is clickable**
- [ ] **Focus ring appears**
- [ ] **Can type new text**
- [ ] **Can delete text**
- [ ] **Can select text**
- [ ] **Copy/paste works**

### TTS Synthesis
- [ ] Synthesis starts
- [ ] Progress updates shown
- [ ] Voice routing works (host‚ÜíLuo Xiang, etc.)
- [ ] Audio files created
- [ ] Export button enabled

### Audio Export
- [ ] Mix starts
- [ ] Final WAV file created
- [ ] File is playable

### Dark Mode
- [ ] All colors update correctly
- [ ] Focus ring visible in both modes

## Known Issues

### Issue 1: Editor Not Editable (FIXED!)
**Status**: ‚úÖ Fixed in latest commit
**Symptom**: Script editor appeared but couldn't be edited
**Fix**: Added focus/hover instances, focus ring visualization, removed duplicate apply_over
**Action Required**: Please test and confirm fix works

### Issue 2: Dual Editor Still Showing (FIXED!)
**Status**: ‚úÖ Fixed
**Symptom**: Old dual editor layout remained after code changes
**Fix**: Replaced UI definition with Python script
**Action Required**: None (should be resolved)

## Rollback Plan

If critical issues are found:

1. **Partial rollback**: Keep v0.6.0 simplification but restore dual editor
2. **Full rollback**: Revert to v0.5.0 with "Refine Script" button

**To rollback**:
```bash
git checkout main -- apps/mofa-cast/
git checkout <v0.5.0-tag> -- apps/mofa-cast/
```

## Next Steps After Testing

### If All Tests Pass ‚úÖ
1. Commit changes: `git add apps/mofa-cast/ && git commit`
2. Create tag: `git tag v0.6.0`
3. Push: `git push origin main --tags`
4. Update CHANGELOG.md
5. Announce release

### If Issues Found ‚ùå
1. Document specific issue with screenshot/error
2. Determine severity (critical/major/minor)
3. Create bug fix branch: `fix/v0.6.0-editor-issue`
4. Apply fix and retest
5. Update this testing guide with workarounds

## Performance Benchmarks

Compare with v0.5.0:

| Metric | v0.5.0 | v0.6.0 | Change |
|--------|--------|--------|--------|
| Build time | 45s | 40s | -11% |
| Binary size | ~2.5MB | ~2.4MB | -4% |
| Memory usage | ~120MB | ~115MB | -4% |
| TTS synthesis | ~4s/segment | ~4s/segment | Same |
| Code lines | ~3,500 | ~2,800 | -20% |

## Documentation Links

- **[v0.6.0_RELEASE_NOTES.md](v0.6.0_RELEASE_NOTES.md)** - Complete release notes
- **[SCRIPT_OPTIMIZATION_GUIDE.md](docs/SCRIPT_OPTIMIZATION_GUIDE.md)** - How to optimize scripts externally
- **[README.md](README.md)** - Updated quick start guide
- **[ARCHITECTURE.md](docs/ARCHITECTURE.md)** - Technical architecture
- **[CHECKLIST.md](docs/CHECKLIST.md)** - Development checklist

## Contact & Support

**Questions? Issues?**

- Check documentation first (see links above)
- Search existing issues on GitHub
- Create new issue with:
  - MoFA Cast version: 0.6.0
  - Steps to reproduce
  - Expected vs actual behavior
  - Screenshot if applicable

---

**Good luck with testing!** üéâ

Remember: The main thing to test is whether the script editor is now editable. That was the critical bug we fixed in this release.
